int main(void) {
  // Initializations
  EncDouble[] in_, l1out_, res_;
  EncDouble t3mp_;
  double[] w, b1, b2;
  int in_size, l1out_neurons, l2out_neurons, i, j, idx, n, segment;
  n = 28;
  in_size = n*n;
  l1out_neurons = 50;
  l2out_neurons = 10;
  l1out_ = new EncDouble[l1out_neurons];
  res_ = new EncDouble[l2out_neurons];
  in_ = new EncDouble[in_size];
  tstart();
  for (i = 0; i < in_size; i++) {
    in_[i] = 0.00005*i;
  }
  tstop();
  w = { 0.36878, 0.09604000000000001, 0.41506, 0.11833000000000005, 0.006699999999999984, 0.43932000000000004, 0.10360000000000003, 0.41513, 0.24429, 0.10282000000000002, 0.42935999999999996, 0.27498, 0.20889999999999997, 0.044810000000000016, 0.13254, 0.010749999999999982, 0.41615, 0.49711000000000005, 0.34123000000000003, 0.20794, 0.06963000000000003, 0.38528, 0.35772000000000004, 0.024849999999999983, 0.18377, 0.36353, 0.39378, 0.22616000000000003, 
0.28263000000000005, 0.42625, 0.32459, 0.12382000000000004, 0.09227999999999997, 0.15442, 0.42866, 0.19794, 0.47384000000000004, 0.10407, 0.15081, 0.24292999999999998, 0.11182000000000003, 0.42877, 0.38432, 0.46621999999999997, 0.38332, 0.22640000000000005, 0.35056, 0.017059999999999964, 0.35529, 0.1441, 0.052779999999999994, 0.003070000000000017, 0.18932, 0.02350000000000002, 0.48585999999999996, 0.08004, 
0.44723999999999997, 0.39148, 0.12405, 0.27049, 0.24638000000000004, 0.32499, 0.48839, 0.18947999999999998, 0.21709, 0.4405, 0.21555000000000002, 0.39634, 0.21181000000000005, 0.28323, 0.34778, 0.35129999999999995, 0.025900000000000034, 0.23475999999999997, 0.19582, 0.26466999999999996, 0.06285000000000002, 0.48866, 0.48441, 0.20465, 0.34331999999999996, 0.24829999999999997, 0.26680000000000004, 0.44224, 
0.1634, 0.36636, 0.07722000000000001, 0.27263000000000004, 0.33165, 0.050929999999999975, 0.23707999999999996, 0.09186000000000005, 0.04559000000000002, 0.28898999999999997, 0.46188, 0.07840000000000003, 0.40425, 0.05797000000000002, 0.050439999999999985, 0.42152, 0.0031799999999999606, 0.39975000000000005, 0.24042999999999998, 0.06711, 0.20847, 0.17748999999999998, 0.47951, 0.12070999999999998, 0.19313999999999998, 0.354, 0.42193, 0.27203, 
0.39022999999999997, 0.11639999999999995, 0.24806, 0.21706999999999999, 0.26957, 0.011270000000000002, 0.36456, 0.1749, 0.1815, 0.44578, 0.38712, 0.37824, 0.15354, 0.09989000000000003, 0.38917, 0.16131, 0.21472999999999998, 0.49051, 0.12788999999999995, 0.23473, 0.24529, 0.04137999999999997, 0.28853, 0.19921999999999995, 0.33287, 0.40686, 0.25658000000000003, 0.39235, 
0.08560000000000001, 0.05452999999999997, 0.17847000000000002, 0.25301, 0.14090999999999998, 0.46372, 0.41206, 0.02241000000000004, 0.44518, 0.29432, 0.47353, 0.12527999999999995, 0.17396, 0.4454, 0.17814999999999998, 0.11399000000000004, 0.37671, 0.45283, 0.47851999999999995, 0.21961000000000003, 0.43365, 0.28178000000000003, 0.25869, 0.44071, 0.18722, 0.16708999999999996, 0.047250000000000014, 0.16375, 
0.40951000000000004, 0.05557000000000001, 0.09423999999999999, 0.13302999999999998, 0.34143, 0.08383000000000002, 0.23009000000000002, 0.43844, 0.01319999999999999, 0.1966, 0.37862, 0.13998999999999995, 0.30241, 0.25824, 0.21839999999999998, 0.053070000000000006, 0.20977999999999997, 0.37466999999999995, 0.44844, 0.44027000000000005, 0.009429999999999994, 0.10760999999999998, 0.15194000000000002, 0.21464, 0.4615, 0.42429, 0.26211, 0.24675000000000002, 
0.26656, 0.4644, 0.22629999999999995, 0.30688000000000004, 0.12721000000000005, 0.15075, 0.39939, 0.05957000000000001, 0.4894, 0.01959999999999995, 0.10044999999999998, 0.43448, 0.23443000000000003, 0.31506, 0.34546, 0.012880000000000003, 0.06570999999999999, 0.47668999999999995, 0.36754, 0.15117000000000003, 0.002630000000000021, 0.0016000000000000458, 0.37986, 0.23319999999999996, 0.37159, 0.27115, 0.34499, 0.27615, 
0.026370000000000005, 0.38477, 0.30734, 0.26464, 0.06580999999999998, 0.06730999999999998, 0.43763, 0.043289999999999995, 0.26605999999999996, 0.027140000000000053, 0.11935000000000001, 0.45876, 0.43339000000000005, 0.005610000000000004, 0.19032, 0.42569999999999997, 0.34058, 0.03054000000000001, 0.0009099999999999664, 0.12861999999999996, 0.49444, 0.13988, 0.40518, 0.39234, 0.24844, 0.41669, 0.38326, 0.34396000000000004, 
0.17208, 0.038839999999999986, 0.12036000000000002, 0.10775000000000001, 0.14986, 0.42511, 0.44171000000000005, 0.28544, 0.30289999999999995, 0.47980999999999996, 0.07301999999999997, 0.47223, 0.33803000000000005, 0.21309, 0.08311999999999997, 0.32393, 0.30686, 0.04849999999999999, 0.14549, 0.11768, 0.40174, 0.49003, 0.25227, 0.29391, 0.35313000000000005, 0.12114000000000003, 0.42903, 0.11056999999999995, 
0.24280000000000002, 0.11892999999999998, 0.020679999999999976, 0.45681, 0.21482999999999997, 0.008520000000000028, 0.07329000000000002, 0.16382000000000002, 0.48118000000000005, 0.06508000000000003, 0.040200000000000014, 0.24419999999999997, 0.39322, 0.48991, 0.42675, 0.1547, 0.03432999999999997, 0.30284999999999995, 0.41022000000000003, 0.35502999999999996, 0.2582, 0.14256000000000002, 0.08894000000000002, 0.14542, 0.42944, 0.06169999999999998, 0.39834, 0.15654, 
0.0006800000000000139, 0.066, 0.09626000000000001, 0.09525, 0.47141, 0.48282, 0.11163999999999996, 0.046619999999999995, 0.03132999999999997, 0.47987, 0.33094999999999997, 0.47709, 0.19757999999999998, 0.48806, 0.09031, 0.06899, 0.31007, 0.11439999999999995, 0.28354999999999997, 0.18498000000000003, 0.23724999999999996, 0.41648, 0.31436, 0.12264000000000003, 0.34894000000000003, 0.39525999999999994, 0.25761, 0.0007599999999999829, 
0.47373, 0.2802, 0.43276000000000003, 0.15761999999999998, 0.32278, 0.08507999999999999, 0.49422, 0.18485000000000001, 0.06509999999999999, 0.11346999999999996, 0.37814000000000003, 0.21946, 0.03769, 0.14593, 0.10388999999999998, 0.4921, 0.22271000000000002, 0.18619999999999998, 0.28171, 0.48927, 0.029880000000000018, 0.24261, 0.21486, 0.19847000000000004, 0.28998999999999997, 0.058130000000000015, 0.43013, 0.42891, 
0.016469999999999985, 0.42833, 0.3603, 0.05864999999999998, 0.36360000000000003, 0.40547, 0.34653999999999996, 0.29547, 0.44482999999999995, 0.32325000000000004, 0.4454, 0.35014, 0.18346, 0.15610999999999997, 0.20817000000000002, 0.34847, 0.035109999999999975, 0.4208, 0.20068000000000003, 0.012929999999999997, 0.47304999999999997, 0.29707, 0.15488000000000002, 0.025959999999999983, 0.023349999999999982, 0.22233000000000003, 0.05536000000000002, 0.33577999999999997, 
0.4098, 0.41748, 0.07213999999999998, 0.15071, 0.14550999999999997, 0.25778, 0.30433, 0.43067999999999995, 0.32484999999999997, 0.34957000000000005, 0.056030000000000024, 0.21333000000000002, 0.34109, 0.005379999999999996, 0.03286, 0.047660000000000036, 0.17047, 0.49285999999999996, 0.26674, 0.43757999999999997, 0.46526, 0.46697, 0.30167, 0.05279999999999996, 0.32604, 0.13774999999999998, 0.07102000000000003, 0.46779000000000004, 
0.30254000000000003, 0.17179, 0.21660999999999997, 0.41791999999999996, 0.39059999999999995, 0.32291000000000003, 0.16859000000000002, 0.41992, 0.14546000000000003, 0.41977, 0.24292000000000002, 0.16332000000000002, 0.23842999999999998, 0.26637999999999995, 0.24575000000000002, 0.15178999999999998, 0.16443000000000002, 0.48409, 0.24431000000000003, 0.18231000000000003, 0.26288, 0.22623, 0.37296, 0.26358000000000004, 0.015359999999999985, 0.13518999999999998, 0.11528, 0.005260000000000042, 
0.21145000000000003, 0.14911999999999997, 0.14683000000000002, 0.30084, 0.24083, 0.06994, 0.42352, 0.36790999999999996, 0.46817, 0.17596, 0.07098000000000004, 0.49171, 0.29217000000000004, 0.04354999999999998, 0.35601, 0.05681000000000003, 0.11301000000000005, 0.41661, 0.11137999999999998, 0.20423000000000002, 0.30686, 0.40842999999999996, 0.26293999999999995, 0.41820999999999997, 0.32338, 0.33631, 0.20379000000000003, 0.12412999999999996, 
0.38995, 0.44442, 0.44816, 0.28163, 0.20729999999999998, 0.15813, 0.34603, 0.1865, 0.40325999999999995, 0.21038, 0.1745, 0.47324, 0.27917000000000003, 0.27646000000000004, 0.44546, 0.05181000000000002, 0.26831000000000005, 0.43162999999999996, 0.48208, 0.0027599999999999847, 0.16774, 0.013500000000000012, 0.11880000000000002, 0.49644, 0.15503, 0.017120000000000024, 0.3853, 0.22209, 
0.34836, 0.27285000000000004, 0.35485, 0.47682, 0.49099, 0.34699, 0.0025800000000000267, 0.39949999999999997, 0.20759000000000005, 0.33628, 0.49, 0.35745000000000005, 0.30864, 0.19743999999999995, 0.06253999999999998, 0.49188, 0.44139, 0.29578000000000004, 0.31015000000000004, 0.42301999999999995, 0.27893999999999997, 0.47030000000000005, 0.09913, 0.28842999999999996, 0.22876999999999997, 0.34569, 0.038390000000000035, 0.44145, 
0.34117, 0.37092, 0.19508000000000003, 0.46874000000000005, 0.23881000000000002, 0.08453999999999995, 0.03148000000000001, 0.16870000000000002, 0.14123000000000002, 0.33231, 0.23101000000000005, 0.20690999999999998, 0.18817, 0.0009700000000000264, 0.07589999999999997, 0.25786, 0.17986000000000002, 0.45208000000000004, 0.49876, 0.31918, 0.4817, 0.14459, 0.24730000000000002, 0.19726999999999995, 0.48636, 0.39968000000000004, 0.07438, 0.44306999999999996, 
0.11847999999999997, 0.020429999999999948, 0.05884999999999996, 0.43965, 0.31767999999999996, 0.32609, 0.04862, 0.30844000000000005, 0.22936, 0.023919999999999997, 0.19249000000000005, 0.41322000000000003, 0.12729000000000001, 0.003369999999999984, 0.24903999999999998, 0.22355000000000003, 0.02618999999999999, 0.41167, 0.09709000000000001, 0.23458999999999997, 0.43332000000000004, 0.36884, 0.48636, 0.30899, 0.37475, 0.49588, 0.0006499999999999839, 0.22507, 
0.28402000000000005, 0.41147, 0.43655, 0.27993999999999997, 0.25346, 0.07782999999999995, 0.46045, 0.26893, 0.27952, 0.09203, 0.39041000000000003, 0.49675, 0.29400000000000004, 0.09144999999999998, 0.04741000000000001, 0.44819, 0.38195, 0.027129999999999987, 0.05846000000000001, 0.27504, 0.43773, 0.31254000000000004, 0.44961, 0.17247, 0.037839999999999985, 0.25124, 0.20862999999999998, 0.13746999999999998, 
0.032409999999999994, 0.10270000000000001, 0.039549999999999974, 0.27097000000000004, 0.03895000000000004, 0.44411, 0.06242000000000003, 0.40097000000000005, 0.25938, 0.29735, 0.28154999999999997, 0.14126, 0.26376999999999995, 0.35356, 0.11138999999999999, 0.05969000000000002, 0.29191, 0.2012, 0.30365, 0.29644000000000004, 0.14418999999999998, 0.20711000000000002, 0.06395, 0.42331, 0.25706, 0.4854, 0.25268, 0.39468000000000003, 
0.09018000000000004, 0.365, 0.11960000000000004, 0.05676999999999999, 0.36584000000000005, 0.38981, 0.39383999999999997, 0.44401, 0.12755000000000005, 0.14872999999999997, 0.27371, 0.32152000000000003, 0.08217000000000002, 0.45484, 0.10738999999999999, 0.35847, 0.06359000000000004, 0.18220999999999998, 0.28474, 0.10329999999999995, 0.12225999999999998, 0.32836, 0.40668, 0.41491, 0.35577000000000003, 0.14007999999999998, 0.43213, 0.17609999999999998, 
0.30737000000000003, 0.38898999999999995, 0.13773999999999997, 0.025980000000000003, 0.38227, 0.34955, 0.48624, 0.08495999999999998, 0.22411999999999999, 0.45981, 0.28420999999999996, 0.12263000000000002, 0.20187999999999995, 0.48221, 0.18538, 0.25459, 0.10668, 0.49078, 0.3897, 0.28933, 0.004750000000000032, 0.16386, 0.19943, 0.09750999999999999, 0.29682, 0.46668, 0.22238999999999998, 0.45669, 
0.21221, 0.19785999999999998, 0.009079999999999977, 0.18035, 0.35297, 0.25798, 0.33184, 0.025390000000000024, 0.20023999999999997, 0.37160000000000004, 0.48436, 0.02942, 0.43254000000000004, 0.31427000000000005, 0.29035, 0.12795, 0.48211000000000004, 0.06889, 0.05385000000000001, 0.10646, 0.27454999999999996, 0.04726999999999998, 0.25927999999999995, 0.06108999999999998, 0.19159000000000004, 0.01591999999999999, 0.42702, 0.25705, 
0.18618, 0.24098999999999998, 0.36254, 0.35840000000000005, 0.13232, 0.41913999999999996, 0.23103, 0.014110000000000011, 0.34626999999999997, 0.36512999999999995, 0.07533000000000001, 0.36846999999999996, 0.28143, 0.27344, 0.10283999999999999, 0.25142, 0.36233000000000004, 0.31087, 0.48679, 0.17596, 0.22129, 0.07321, 0.24634, 0.006469999999999976, 0.18147999999999997, 0.16527999999999998, 0.41171, 0.19013999999999998, 
0.21933999999999998, 0.30345, 0.18562999999999996, 0.17515999999999998, 0.36585, 0.22682999999999998, 0.42390000000000005, 0.31989999999999996, 0.04842000000000002, 0.30718999999999996, 0.10189999999999999, 0.28237, 0.48511, 0.20716, 0.03154000000000001, 0.060960000000000014, 0.0348, 0.10774, 0.04504999999999998, 0.32377, 0.06269999999999998, 0.30094, 0.46316999999999997, 0.23619, 0.28171999999999997, 0.11201000000000005, 0.38961999999999997, 0.17730999999999997 };  

  b1 = { 185.0, 203.0, 192.0, 21.0, 99.0, 43.0, 30.0, 237.0, 83.0, 55.0, 53.0, 
         88.0, 5.0, 134.0, 255.0, 212.0, 217.0, 79.0, 28.0, 120.0, 130.0, 102.0, 
         18.0, 31.0, 204.0, 256.0, 156.0, 61.0, 224.0, 49.0, 30.0, 216.0, 115.0, 
         152.0, 200.0, 219.0, 130.0, 13.0, 90.0, 169.0, 115.0, 215.0, 72.0, 189.0, 
         245.0, 122.0, 210.0, 0.0, 125.0, 76.0 };
  b2 = { 166.0, 139.0, 171.0, 172.0, 85.0, 101.0, 196.0, 172.0, 21.0, 28.0 };    
  // Encrypted Computation
  // First FC Layer
  segment = in_size / l1out_neurons;
  tstart();
  for (j = 0; j < l1out_neurons; j++) {
    l1out_[j] = (b1[j]);
    for (i = 0; i < in_size; i++) {
      idx = (j*segment) + (i % segment);
      t3mp_ = (in_[i]) * (w[idx]);
      reduce_noise(t3mp_);
      match_params(l1out_[j], t3mp_);
      l1out_[j] += t3mp_;
    }
  }
  // Activation Function (Square)
  for (i = 0; i < l1out_neurons; i++) {
    l1out_[i] *= l1out_[i];
    reduce_noise(l1out_[i]);
  }
  // Second FC Layer
  segment = in_size / l2out_neurons;
  for (j = 0; j < l2out_neurons; j++) {
    res_[j] = b2[j];
    for (i = 0; i < l1out_neurons; i++) {
      idx = (j*segment) + (i % segment);
      t3mp_ = (l1out_[i]) * (w[idx]);
      reduce_noise(t3mp_);
      match_params(res_[j], t3mp_);
      res_[j] += t3mp_;
    }
  }
  tstop();

  // Print Results
  for (i = 0; i < l2out_neurons; i++) { 
    print(res_[i]); 
  }
  return 0;
}
